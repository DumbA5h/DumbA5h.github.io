## Stealing User/Domain Passwords and Hashes Covertly

### Background

#### LSASS (Local Security Authority Subsystem Service)

* It is a process in Windows that is responsible for enforcing the security policy on the system.
* It verifies users logging on to a Windows computer or server, handles password changes, and creates access tokens.
* Whenever a user logs in to a system, the passwords or hashes are stored in the memory of LSASS process.
* This can be levereged to dump the creds from the memory of the process.
* But for this you need to have administrative privileges, now onwards I'll just assume you have that :).

#### Simple method, Use [Mimikatz](https://github.com/gentilkiwi/mimikatz)

* It's a tool to extract plaintexts passwords, hash, PIN code and kerberos tickets from memory, but not limited to it, I'll post more blogs on that later.

![Mimikatz](/assets/images/mimikatz.png)

* It's an easy to use tool, but now almost every antivirus on this planet marks it as a malicious software, so making it hard to use during red team ops.

#### Using [ProcDump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) and Mimikatz

* ProcDump is a sysinternals utility by Microsoft, so won't be marked as malware by any antivirus.
* It is a legit utility used for monitoring an application.
* It creates a dump file of memory of a process.
* We can use it for dumping the memory of LSASS process.

![LSASS Memory](/assets/images/lsass.png)

* Now we can download that dump file in our system and extract passwords and hashes using mimikatz.

![mimi-dump](/assets/images/mimi-dump.png)

* This method is best suitable in environments where endpoints are protected by antivirus programs.


#### Happy Hacking
